(function(){'use strict';const form=document.getElementById('search-form');const placaInput=document.getElementById('placa');if(placaInput){placaInput.addEventListener('input',function(){this.value=this.value.toUpperCase().replace(/[^A-Z0-9]/g,'')})}if(form){form.addEventListener('submit',async function(e){e.preventDefault();const placa=placaInput.value;const btn=this.querySelector('button[type="submit"]');btn.disabled=true;btn.textContent='Buscando...';try{const response=await fetch('/fornecedor/veiculos/buscar',{method:'POST',headers:{'Content-Type':'application/x-www-form-urlencoded'},body:`placa=${encodeURIComponent(placa)}`});const result=await response.json();if(result.sucesso){displayVehicle(result.veiculo)}else{showMessage('error',result.mensagem);document.getElementById('result-section').style.display='none'}}catch(error){showMessage('error','Erro ao buscar veículo');document.getElementById('result-section').style.display='none'}finally{btn.disabled=false;btn.textContent='Buscar'}})}function displayVehicle(v){const section=document.getElementById('result-section');const title=document.getElementById('vehicle-title');const info=document.getElementById('vehicle-info');const btn=document.getElementById('view-details-btn');title.textContent=`${v.marca} ${v.modelo} - ${v.placa}`;info.innerHTML=`
<div class="info-item"><span class="label">Ano:</span> ${v.ano}</div>
<div class="info-item"><span class="label">Cor:</span> ${v.cor}</div>
<div class="info-item"><span class="label">Combustível:</span> ${v.combustivel}</div>
<div class="info-item"><span class="label">KM Atual:</span> ${parseInt(v.km_atual).toLocaleString('pt-BR')}</div>
`;btn.href=`/fornecedor/veiculos/${v.id}`;section.style.display='block'}function showMessage(type,text){const container=document.getElementById('message-container');if(!container)return;const message=document.createElement('div');message.className=`message message-${type}`;message.innerHTML=`<span class="message-icon">${type==='success'?'✓':'✗'}</span><span class="message-text">${text}</span><button class="message-close" onclick="this.parentElement.remove()">×</button>`;container.appendChild(message);setTimeout(()=>message.remove(),5000);window.scrollTo({top:0,behavior:'smooth'})}window.showMessage=showMessage})();
