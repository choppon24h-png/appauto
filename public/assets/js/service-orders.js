(function(){'use strict';const stars=document.querySelectorAll('.rating-stars .star');const ratingValue=document.getElementById('rating-value');stars.forEach(star=>{star.addEventListener('click',function(){const rating=this.getAttribute('data-rating');ratingValue.value=rating;stars.forEach(s=>{if(s.getAttribute('data-rating')<=rating){s.classList.add('active')}else{s.classList.remove('active')}})})});const ratingForm=document.getElementById('rating-form');if(ratingForm){ratingForm.addEventListener('submit',async function(e){e.preventDefault();const rating=ratingValue.value;if(!rating){alert('Por favor, selecione uma avaliação');return}const osId=this.getAttribute('data-os-id');const formData=new FormData(this);try{const response=await fetch(`/cliente/os/${osId}/avaliar`,{method:'POST',headers:{'X-Requested-With':'XMLHttpRequest'},body:formData});const result=await response.json();if(result.sucesso){showMessage('success',result.mensagem);setTimeout(()=>window.location.reload(),1000)}else{showMessage('error',result.mensagem)}}catch(error){showMessage('error','Erro ao enviar avaliação')}})}function showMessage(type,text){const container=document.getElementById('message-container');if(!container)return;const message=document.createElement('div');message.className=`message message-${type}`;message.innerHTML=`<span class="message-icon">${type==='success'?'✓':'✗'}</span><span class="message-text">${text}</span><button class="message-close" onclick="this.parentElement.remove()">×</button>`;container.appendChild(message);setTimeout(()=>message.remove(),5000);window.scrollTo({top:0,behavior:'smooth'})}window.showMessage=showMessage})();
