(function(){'use strict';window.openAddClientModal=function(){document.getElementById('add-client-modal').classList.add('active')};window.closeAddClientModal=function(){document.getElementById('add-client-modal').classList.remove('active')};const form=document.getElementById('add-client-form');if(form){form.addEventListener('submit',async function(e){e.preventDefault();const formData=new FormData(this);const btn=this.querySelector('button[type="submit"]');btn.disabled=true;btn.textContent='Adicionando...';try{const response=await fetch('/fornecedor/clientes',{method:'POST',headers:{'X-Requested-With':'XMLHttpRequest'},body:formData});const result=await response.json();if(result.sucesso){showMessage('success',result.mensagem);closeAddClientModal();setTimeout(()=>window.location.reload(),1000)}else{showMessage('error',result.mensagem)}}catch(error){showMessage('error','Erro ao adicionar cliente')}finally{btn.disabled=false;btn.textContent='Adicionar'}})}window.removeClient=async function(id,name){if(!confirm(`Remover cliente ${name}?`))return;try{const response=await fetch(`/fornecedor/clientes/${id}`,{method:'DELETE',headers:{'X-Requested-With':'XMLHttpRequest','Content-Type':'application/json'},body:JSON.stringify({csrf_token:document.querySelector('[name="csrf_token"]').value})});const result=await response.json();if(result.sucesso){showMessage('success',result.mensagem);setTimeout(()=>window.location.reload(),1000)}else{showMessage('error',result.mensagem)}}catch(error){showMessage('error','Erro ao remover cliente')}};function showMessage(type,text){const container=document.getElementById('message-container');if(!container)return;const message=document.createElement('div');message.className=`message message-${type}`;message.innerHTML=`<span class="message-icon">${type==='success'?'✓':'✗'}</span><span class="message-text">${text}</span><button class="message-close" onclick="this.parentElement.remove()">×</button>`;container.appendChild(message);setTimeout(()=>message.remove(),5000);window.scrollTo({top:0,behavior:'smooth'})}window.showMessage=showMessage})();
